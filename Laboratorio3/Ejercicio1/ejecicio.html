<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Búsqueda dinámica</title>
</head>

<body>
  <h1>Búsqueda</h1>
  <!-- Caja de texto donde el usuario escribe lo que quiere buscar -->
  <input type="text" id="search" placeholder="Término a buscar ...">
  <!-- Aquí se mostrarán los resultados -->
  <div id="results"></div>

  <script>
    // Escucha cuando el usuario escribe algo en el input
    document.getElementById('search').addEventListener('input', function () {
      // Guardamos el texto que escribió el usuario
      let query = this.value;

      // Si escribió menos de 3 letras, no buscamos nada y limpiamos resultados
      if (query.length < 3) {
        document.getElementById('results').innerHTML = '';
        return;
      }

      // Creamos un objeto para hacer la solicitud al servidor (AJAX)
      let xhr = new XMLHttpRequest();

      // Preparamos la solicitud, le decimos que use el método GET y la URL con el texto buscado
      xhr.open('GET', 'https://api.example.com/search?q=' + encodeURIComponent(query), true);

      // Indicamos que esperamos una respuesta en formato JSON
      xhr.responseType = 'json';

      // Cuando llega la respuesta del servidor
      xhr.onload = function () {
        if (xhr.status === 200) {
          // Guardamos los resultados que llegaron
          let results = xhr.response;
          // Seleccionamos el div donde se mostrarán los resultados
          let resultsDiv = document.getElementById('results');
          // Limpiamos lo que había antes en los resultados
          resultsDiv.innerHTML = '';

          // Por cada resultado recibido, creamos un párrafo y lo mostramos
          results.forEach(function (result) {
            let resultElement = document.createElement('p');
            resultElement.textContent = result.title; // Mostramos el título
            resultsDiv.appendChild(resultElement); // Lo agregamos al div de resultados
          });
        } else {
          // Si hubo un error en la respuesta, lo mostramos en la consola
          console.error('Error: ' + xhr.status);
        }
      };

      // Si la solicitud falla (por ejemplo, no hay conexión)
      xhr.onerror = function () {
        console.error('Request failed');
      };

      // Enviamos la solicitud al servidor
      xhr.send();
    });
  </script>

</body>
</html>